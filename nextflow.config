/*
 * -------------------------------------------------
 *  sheynkman-lab/Long-Read-Proteogenomics Nextflow config file
 * -------------------------------------------------
 * Default config options for all environments.
 */

// Global default params, used in configs
params {

  // Workflow flags
  max_cpus = 32
  outdir = './results'
  name = false
  
  gencode_gtf = false
  
  gencode_transcript_fasta = false
  gencode_translation_fasta = false

  gencode_fasta = false

  fastq_read_1 = false
  fastq_read_2 = false
  star_genome_dir = false

  sample_ccs = false
  primers_fasta = false

  hexamer = false
  logit_model = false

  sample_kallisto_tpm = false
  normalized_ribo_kallisto = false

  uniprot_fasta = false

  protein_coding_only = false
  refine_cutoff = 0.0

  
    
  // Boilerplate options
  help = false
}

// Ensure that docker is enab
docker.enabled = true
process.container = 'gsheynkmanlab/proteogenomics-base'


// Define the exact container we need to use for the individual processes:
process {
    // Overwrites 
    //withName: generate_reference_tables {
    //    container = 'gsheynkmanlab/generate-reference-tables'
    //}
    //withName: make_gencode_database {
    //    container = 'gsheynkmanlab/gencode-db'
    //}
    withName: isoseq3 {
        container = 'gsheynkmanlab/isoseq3'
    }
    withName: sqanti3 {
        container = 'gsheynkmanlab/sqanti3'
        // container = 'milescsmith/sqanti3'
    }
    //withName: make_pacbio_6frm_gene_grouped {
    //    container = 'gsheynkmanlab/six-frame-translation'
    //}
    //withName: transcriptome_summary {
    //    container = 'gsheynkmanlab/transcriptome-summary'
    //}
    withName: cpat {
        container = 'gsheynkmanlab/cpat:addr'
    }
    //withName: orf_calling {
    //    container = 'gsheynkmanlab/orf_calling'
    //}
    //withName: generate_refined_database {
    //    container = 'gsheynkmanlab/refined-database-generation'
    //}
    //withName: make_pacbio_cds_gtf {
    //    container = 'gsheynkmanlab/pb-cds-gtf'
    //}

    withName: metamorpheus_with_sample_specific_database{
        container = 'smithchemwisc/metamorpheus:lrproteogenomics'
    }
    withName: metamorpheus_with_gencode_database{
        container = 'smithchemwisc/metamorpheus:lrproteogenomics'
    }
    withName: mass_spec_raw_convert {
        container = 'chambm/pwiz-skyline-i-agree-to-the-vendor-licenses'
    }


}
// Export these variables to prevent local Python/R libraries from conflicting with those in the container
env {
  PYTHONNOUSERSITE = 1
  R_PROFILE_USER = "/.Rprofile"
  R_ENVIRON_USER = "/.Renviron"
}

// Capture exit codes from upstream processes when piping
process.shell = ['/bin/bash', '-euo', 'pipefail']

timeline {
  enabled = true
  file = "${params.outdir}/pipeline_info/execution_timeline.html"
}
report {
  enabled = true
  file = "${params.outdir}/pipeline_info/execution_report.html"
}
trace {
  enabled = true
  file = "${params.outdir}/pipeline_info/execution_trace.txt"
}
dag {
  enabled = true
  file = "${params.outdir}/pipeline_info/pipeline_dag.svg"
}

manifest {
  name = 'sheynkman-lab/Long-Read-Proteogenomics'
  author = 'Sheynkman Group and Smith Group'
  homePage = 'https://github.com/sheynkman-lab/Long-Read-Proteogenomics'
  description = 'A workflow for delineating the Human Proteome at Isoform Resolution through Long-read Proteog'
  mainScript = 'main.nf'
  nextflowVersion = '>=19.10.0'
  version = '1.0dev'
}
profiles {
  test { includeConfig 'conf/executors/test.config' }
  toy { includeConfig 'conf/executors/toy.config'}
  metamorpheus { includeConfig 'conf/executors/test_metamorpheus.config'}
}
